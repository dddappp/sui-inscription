aggregates:
  Inscription:
    metadata:
      HasStoreAbility: true
      #Preprocessors:
      #  - MOVE_CRUD_IT
      #CRUD_IT_NO_DELETE: true
      #CRUD_IT_NO_UPDATE: true
      #CRUD_IT_CREATE_METHOD_NAME: Mint
      #MOVE_NO_VERSION_PROPERTY: true
    id:
      name: Id
      type: UID
    properties:
      Hash:
        type: vector<u8>
      SlotNumber:
        type: u8
      Round:
        type: u64
      Inscriber:
        type: address
      Timestamp:
        type: u64
      Amount:
        type: u64
      Nonce:
        type: u128
      Content:
        type: String
        length: 1000
    methods:
      Mint:
        isCreationCommand: true
        parameters:
          SlotNumber:
            type: u8
          Round:
            type: u64
          Amount:
            type: u64
          Nonce:
            type: u128
          Content:
            type: String
            length: 1000
          Clock:
            referenceType: Clock
            isIgnoredInEvent: true
        event:
          name: InscriptionMinted
          #isObjectShared: true
          #isObjectFrozen: true
          properties:
            Inscriber:
              type: address
            Timestamp:
              type: u64
            Hash:
              type: vector<u8>

  Certificate:
    metadata:
      HasStoreAbility: true
      Preprocessors:
        - MOVE_CRUD_IT
      CRUD_IT_NO_DELETE: true
      CRUD_IT_NO_UPDATE: true
      CRUD_IT_CREATE_METHOD_NAME: Issue
      MOVE_NO_VERSION_PROPERTY: true
    friends:
      - Slot.Advance
    id:
      name: Id
      type: UID
    properties:
      InscriptionId:
        type: ID
      InscriptionHash:
        type: vector<u8>
      SlotNumber:
        type: u8
      Round:
        type: u64
      Inscriber:
        type: address
      InscriptionTimestamp:
        type: u64
      Amount:
        type: u64
      InscriptionNonce:
        type: u128
      #InscriptionContent:
      #  type: String
      #  length: 1000
      #CertificateType:
      #  type: u8
      #  #type: CertificateType
    methods:
      Issue:
        event:
          name: CertificateIssued
          #isObjectShared: true
          #isObjectFrozen: true
          properties:
            Inscriber:
              isOwner: true # Transfer the object to the account address indicated by this property
              #type: address

  Slot:
    metadata:
      #Preprocessors:
      #  - MOVE_CRUD_IT
      #CRUD_IT_NO_DELETE: true
      #CRUD_IT_NO_UPDATE: true
      #CRUD_IT_CREATE_METHOD_NAME: Create
    id:
      name: SlotNumber
      type: u8
      generator:
        class: assigned # 'increment', 'UUID', etc.
        tableName: SlotNumberTable # Used to check the assigned Id., etc.
    properties:
      GenesisTimestamp:
        type: u64
      SlotMaxAmount:
        type: u64
      MintedAmount:
        type: u64
        defaultLogic:
          Move:
            '0'
      Round:
        type: u64
        defaultLogic:
          Move:
            '0'
      QualifiedRound:
        type: u64
        description: previous qualified round
        defaultLogic:
          Move:
            '0'
      QualifiedInscriptionId:
        type: ID
        description: previous qualified inscription Id.
      QualifiedHash:
        type: vector<u8>
        description: previous qualified inscription hash.
      QualifiedTimestamp:
        type: u64
        description: previous qualified inscription timestamp.
      QualifiedDifference:
        type: u64
        description: previous qualified difference.
      CandidateInscriptionId:
        type: ID
        description: candidate inscription Id.
      CandidateHash:
        type: vector<u8>
        description: candidate inscription hash.
      CandidateInscriber:
        type: address
      CandidateTimestamp:
        type: u64
        description: candidate inscription timestamp.
      CandidateAmount:
        type: u64
      CandidateNonce:
        type: u128
      CandidateDifference:
        type: u64
        description: candidate difference.
    methods:
      Create:
        isCreationCommand: true
        parameters:
          Clock:
            referenceType: Clock
            isIgnoredInEvent: true
        event:
          name: SlotCreated
          isObjectShared: true
          #isObjectFrozen: true
          properties:
            GenesisTimestamp:
              type: u64
            SlotMaxAmount:
              type: u64

      PutUpCandidate:
        parameters:
          CandidateInscription:
            referenceType: Inscription
            eventPropertyName: CandidateInscriptionId
          Clock:
            referenceType: Clock
            isIgnoredInEvent: true
        event:
          name: CandidateInscriptionPutUp
          properties:
            Round:
              type: u64
            CandidateInscriptionId:
              type: ID

      Advance:
        description: advance it to the next round.
        parameters:
          Clock:
            referenceType: Clock
            isIgnoredInEvent: true
#          CandidateInscription:
#            referenceType: Inscription
#            eventPropertyName: CandidateInscriptionId
#          WitnessInscription:
#            referenceType: Inscription
#            eventPropertyName: WitnessInscriptionId
        event:
          name: SlotAdvanced
          properties:
            Round:
              type: u64
